<!-- src/app/products/products.html -->
<div class="products-container">
  <div class="container">
    <header class="page-header">
      <h1>Our Fresh Products</h1>
      <p>Discover our delicious selection of freshly baked goods</p>
    </header>

    <div class="filters">
      <div class="filter-group">
        <label for="category">Category:</label>
        <select id="category" [(ngModel)]="selectedCategory" (change)="filterProducts()">
          <option value="">All Categories</option>
          <option *ngFor="let category of productService.categories()" [value]="category">{{category}}</option>
        </select>
      </div>

      <div class="search-group">
        <label for="search">Search:</label>
        <input
          id="search"
          type="text"
          placeholder="Search products..."
          [(ngModel)]="searchTerm"
          (input)="filterProducts()"
        />
      </div>
    </div>

    <div class="products-grid" *ngIf="!productService.isLoading(); else loadingTemplate">
      <div class="product-card" *ngFor="let product of filteredProducts()">
        <div class="product-image">
          <img [src]="product.imageUrl || '/assets/images/default-product.jpg'"
               [alt]="product.name"
               (error)="onImageError($event)">
          <div class="product-category">{{product.category}}</div>
        </div>

        <div class="product-info">
          <h3>{{product.name}}</h3>
          <p class="product-description">{{product.description}}</p>
          <div class="product-footer">
            <span class="product-price">${{product.price.toFixed(2)}}</span>
            <button
              class="add-to-cart-btn"
              [class.unavailable]="!product.available"
              [disabled]="!product.available"
              (click)="addToCart(product)"
            >
              {{product.available ? 'Add to Cart' : 'Unavailable'}}
            </button>
          </div>
        </div>
      </div>
    </div>

    <ng-template #loadingTemplate>
      <div class="loading">
        <div class="spinner"></div>
        <p>Loading our delicious products...</p>
      </div>
    </ng-template>

    <div class="no-products" *ngIf="!productService.isLoading() && filteredProducts().length === 0">
      <h3>No products found</h3>
      <p *ngIf="searchTerm() || selectedCategory()">
        Try adjusting your filters or search terms.
      </p>
      <p *ngIf="!searchTerm() && !selectedCategory()">
        We're currently updating our product catalog. Please check back soon!
      </p>
    </div>
  </div>
</div>
