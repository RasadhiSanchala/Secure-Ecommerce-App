<!-- frontend/src/app/admin/dashboard/admin-dashboard.html -->
<div class="admin-dashboard">
  <div class="container">
    <!-- Header -->
    <div class="dashboard-header">
      <div class="header-content">
        <h1>Admin Dashboard</h1>
        <p>Welcome back! Here's what's happening in your store.</p>
      </div>
      <div class="header-actions">
        <button class="btn btn-secondary" (click)="refreshData()">
          <span>🔄</span> Refresh Data
        </button>
      </div>
    </div>

    <!-- Stats Overview -->
    <div class="stats-grid">
      <div class="stat-card orders">
        <div class="stat-icon">📋</div>
        <div class="stat-content">
          <h3>{{ dashboardStats().totalOrders }}</h3>
          <p>Total Orders</p>
          <span class="stat-meta">{{ dashboardStats().pendingOrders }} pending</span>
        </div>
      </div>

      <div class="stat-card revenue">
        <div class="stat-icon">💰</div>
        <div class="stat-content">
          <h3>{{ formatCurrency(dashboardStats().totalRevenue) }}</h3>
          <p>Total Revenue</p>
          <span class="stat-meta">Avg: {{ formatCurrency(dashboardStats().averageOrderValue) }}</span>
        </div>
      </div>

      <div class="stat-card products">
        <div class="stat-icon">📦</div>
        <div class="stat-content">
          <h3>{{ dashboardStats().totalProducts }}</h3>
          <p>Total Products</p>
          <span class="stat-meta">{{ dashboardStats().activeProducts }} active</span>
        </div>
      </div>

      <div class="stat-card users">
        <div class="stat-icon">👥</div>
        <div class="stat-content">
          <h3>{{ dashboardStats().totalUsers }}</h3>
          <p>Total Users</p>
          <span class="stat-meta">{{ dashboardStats().recentUsersCount }} this week</span>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <h2>Quick Actions</h2>
      <div class="actions-grid">
        <a routerLink="/admin/products" class="action-card">
          <span class="action-icon">📦</span>
          <h3>Manage Products</h3>
          <p>Add, edit, or remove products</p>
        </a>

        <a routerLink="/admin/orders" class="action-card">
          <span class="action-icon">📋</span>
          <h3>Manage Orders</h3>
          <p>View and update order statuses</p>
        </a>

        <a routerLink="/admin/users" class="action-card">
          <span class="action-icon">👥</span>
          <h3>Manage Users</h3>
          <p>View and manage user accounts</p>
        </a>

        <a routerLink="/products" class="action-card">
          <span class="action-icon">👁️</span>
          <h3>View Store</h3>
          <p>See your store as customers do</p>
        </a>
      </div>
    </div>

    <!-- Dashboard Content Grid -->
    <div class="dashboard-content">
      <!-- Recent Orders -->
      <div class="dashboard-card recent-orders">
        <div class="card-header">
          <h2>Recent Orders</h2>
          <a routerLink="/admin/orders" class="view-all-link">View All</a>
        </div>

        <div class="orders-list" *ngIf="recentOrders().length > 0; else noRecentOrders">
          <div class="order-item" *ngFor="let order of recentOrders()">
            <div class="order-info">
              <h4>Order #{{ order._id.slice(-8).toUpperCase() }}</h4>
              <p class="customer">{{ order.user.name }}</p>
              <p class="order-date">{{ formatDate(order.createdAt) }}</p>
            </div>
            <div class="order-details">
              <span class="order-total">{{ formatCurrency(order.total) }}</span>
              <span class="status-badge" [style.background-color]="getStatusColor(order.status)">
                {{ getStatusText(order.status) }}
              </span>
            </div>
          </div>
        </div>

        <ng-template #noRecentOrders>
          <div class="empty-state">
            <p>No recent orders</p>
          </div>
        </ng-template>
      </div>

      <!-- Low Stock Products -->
      <div class="dashboard-card low-stock">
        <div class="card-header">
          <h2>Low Stock Alert</h2>
          <a routerLink="/admin/products" class="view-all-link">Manage Stock</a>
        </div>

        <div class="stock-list" *ngIf="lowStockProducts().length > 0; else noLowStock">
          <div class="stock-item" *ngFor="let product of lowStockProducts()">
            <div class="product-info">
              <h4>{{ product.name }}</h4>
              <p class="category">{{ product.category }}</p>
            </div>
            <div class="stock-info">
              <span class="stock-count warning">{{ product.stock }} left</span>
              <span class="price">{{ formatCurrency(product.price) }}</span>
            </div>
          </div>
        </div>

        <ng-template #noLowStock>
          <div class="empty-state success">
            <p>✅ All products are well stocked!</p>
          </div>
        </ng-template>
      </div>

      <!-- Recent Users -->
      <div class="dashboard-card recent-activity">
        <div class="card-header">
          <h2>Recent Users</h2>
          <a routerLink="/admin/users" class="view-all-link">View All</a>
        </div>

        <!-- Loading State -->
        <div class="loading-state" *ngIf="isLoadingUsers()">
          <div class="spinner"></div>
          <p>Loading recent users...</p>
        </div>

        <!-- Users List -->
        <div class="activity-list" *ngIf="!isLoadingUsers() && recentUsers().length > 0; else noActivity">
          <div class="activity-item" *ngFor="let user of recentUsers()">
            <div class="user-avatar">{{ getUserInitials(user.name) }}</div>
            <div class="user-info">
              <h4>{{ user.name }}</h4>
              <p class="user-email">{{ user.email }}</p>
              <p class="join-date">{{ getJoinDateText(user.createdAt) }}</p>
            </div>
            <div class="user-role">
              <span class="role-badge" [class.admin]="user.isAdmin">
                {{ user.isAdmin ? 'Admin' : 'User' }}
              </span>
            </div>
          </div>
        </div>

        <ng-template #noActivity>
          <div class="empty-state" *ngIf="!isLoadingUsers()">
            <p>No recent user activity</p>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</div>
